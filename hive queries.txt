1) SELECT count(*), org FROM prenoms LATERAL VIEW EXPLODE(prenoms.origin) origins as org group by org;

2) select count(temp.foo) from ((select count(org) as foo from prenoms lateral view explode(prenoms.origin) origins as org group by prenoms.prenom) as temp) group by temp.foo;

3) select temp.foo/sum(temp.foo), temp.gnd from ((select count(*) as foo, gnd FROM prenoms lateral view explode(prenoms.gender) genders as gnd group by gnd) as temp) group by temp.gnd;